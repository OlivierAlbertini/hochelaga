"use strict";var _createClass=function(){function t(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(e,i,n){return i&&t(e.prototype,i),n&&t(e,n),e}}();function _classCallCheck(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}!function(t){var e={position:"right",showBackLink:!0,keycodeOpen:null,keycodeClose:27,submenuLinkBefore:"",submenuLinkAfter:"",backLinkTitle:"",backLinkClass:"",backLinkBefore:"",backLinkAfter:""},i=function(){function e(t){_classCallCheck(this,e),this.options=t,this._menu=t.elem,this._menu.find("ul:first").wrap('<div class="slider">'),this._anchors=this._menu.find("a"),this._slider=this._menu.find(".slider:first"),this._level=0,this._isOpen=!1,this._isAnimating=!1,this._hasMenu=this._anchors.length>0,this._lastAction=null,this._setupEventHandlers(),this._setupMenu(),this._hasMenu&&this._setupSubmenus()}return _createClass(e,[{key:"toggle",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,e=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],i=void 0;null!==t?(t?(i=0,this._isOpen=!0):(i="left"===this.options.position?"-100%":"100%",this._isOpen=!1),this._triggerEvent(),e?this._triggerAnimation(this._menu,i):(this._pauseAnimations(this._triggerAnimation.bind(this,this._menu,i)),this._isAnimating=!1)):this._isOpen?this.close():this.open()}},{key:"open",value:function(){var t=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];this._lastAction="open",this.toggle(!0,t)}},{key:"close",value:function(){var t=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];this._lastAction="close",this.toggle(!1,t)}},{key:"back",value:function(){this._lastAction="back",this._navigate(null,-1)}},{key:"navigateTo",value:function(e){var i=this;if(!(e=this._menu.find(t(e)).first()).length)return!1;var n=e.parents("ul"),s=n.length-1;if(0===s)return!1;this._pauseAnimations(function(){i._level=s,n.show().first().addClass("active"),i._triggerAnimation(i._slider,100*-i._level)})}},{key:"_setupEventHandlers",value:function(){var e=this;this._hasMenu&&this._anchors.click(function(i){var n=t(i.target).is("a")?t(i.target):t(i.target).parents("a:first");e._navigate(n)}),t(this._menu.add(this._slider)).on("transitionend msTransitionEnd",function(){e._isAnimating=!1,e._triggerEvent(!0)}),t(document).keydown(function(i){switch(i.which){case e.options.keycodeClose:e.close(),t(".overlay").hide();break;case e.options.keycodeOpen:e.open();break;default:return}i.preventDefault()}),this._menu.on("sm.back-after",function(){var t="ul "+".active ".repeat(e._level+1);e._menu.find(t).removeClass("active").hide()})}},{key:"_triggerEvent",value:function(){var t=arguments.length>0&&void 0!==arguments[0]&&arguments[0],e="sm."+this._lastAction;t&&(e+="-after"),this._menu.trigger(e)}},{key:"_navigate",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;if(!this._isAnimating){var i=-100*(this._level+e);if(e>0){if(!t.next("ul").length)return;t.next("ul").addClass("active").show()}else if(0===this._level)return;this._lastAction=e>0?"forward":"back",this._level=this._level+e,this._triggerAnimation(this._slider,i)}}},{key:"_triggerAnimation",value:function(t,e){this._triggerEvent(),-1===String(e).indexOf("%")&&(e+="%"),t.css("transform","translateX("+e+")"),this._isAnimating=!0}},{key:"_setupMenu",value:function(){var t=this;this._pauseAnimations(function(){switch(t.options.position){case"left":t._menu.css({left:0,right:"auto",transform:"translateX(-100%)"});break;default:t._menu.css({left:"auto",right:0})}t._menu.show()})}},{key:"_pauseAnimations",value:function(t){this._menu.addClass("no-transition"),t(),this._menu[0].offsetHeight,this._menu.removeClass("no-transition")}},{key:"_setupSubmenus",value:function(){var e=this;this._anchors.each(function(i,n){if((n=t(n)).next("ul").length){n.click(function(t){t.preventDefault()});var s=n.text();if(n.html(e.options.submenuLinkBefore+s+e.options.submenuLinkAfter),e.options.showBackLink){var a=s;e.options.backLinkTitle&&(a=e.options.backLinkTitle);var o=t('<a href class="slide-menu-control '+e.options.backLinkClass+'" data-action="back">'+a+"</a>");o.html(e.options.backLinkBefore+o.text()+e.options.backLinkAfter),n.next("ul").prepend(t("<li>").append(o))}}})}}]),e}();t("body").on("click",".slide-menu-control",function(e){var i=void 0,n=t(this).data("target");if((i=n&&"this"!==n?t("#"+n):t(this).parents(".slide-menu:first")).length){var s=i.data("slideMenu"),a=t(this).data("action");return s&&"function"==typeof s[a]&&s[a](),!1}}),t.fn.slideMenu=function(n){if(t(this).length){(n=t.extend({},e,n)).elem=t(this);var s=new i(n);return t(this).data("slideMenu",s),s}console.warn("Slide Menu: Unable to find menu DOM element. Maybe a typo?")}}(jQuery);