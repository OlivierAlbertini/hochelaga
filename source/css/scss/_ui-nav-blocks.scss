// @file ui-nav-blocks.scss

// Grid rules for cards and teasers
// May or may not be part of this stylesheet
.vdm-cards-wrapper,
.vdm-teasers-wrapper {
  @extend .container;
  &.neutral-light {
    background-color: $vdm-grey-light;
  }
}

// Teasers are stacked horizontally and are not displayed side by side in a grid, ever
// Teasers may contain lateral images, these images will move up on smaller breakpoints
// Teasers are laid out in a horizontal flex axis

// Add extra classes here that need to be invoked for responsible or semnatic purposes
// Ex : icon-left, image top

// Grid wrapper styles only for teasers
// More wrapper rules, may or may not belong to the base object styles
.vdm-teasers,
.vdm-teasers-mixin {
  list-style-type: none;
  padding-left: 0;
  @include make-row();
  margin-top: 0;
  margin-bottom: 0;
  .vdm-teaser,
  .vdm-teaser-mixin {
    @include make-col-ready();
    margin-bottom: $grid-gutter-width;
  }
  // Vertical grid types, equal heights
  &.grid-type-grid {
    .vdm-teaser,
    .vdm-teaser-mixin {
      @include make-col(12);
      @include media-breakpoint-up(md) {
        @include make-col(6);
      }
    }
    // equal heights
    .vdm-teaser-body {
      height: 100%;
      &:last-child {
        margin-top: auto;
      }
    }
  }
}

// Mixin application tests
// Function reference for the master function for styling this block type

/**
  * 
  *
  * @mixin teaser-variant($icon: false, $image: false, $case: false, $scale: false)
  *
  * @arg $icon [false ,right, left]
  * @arg $image [false ,right, left]
  * @arg $case [false, arrow-block, compact, inline-flex, category-block]
  * @arg $scale [false, small, large, larger] -- images for now
  *
  * Always called from the hyperlink level -- all styles are returned inside .vdm-teaser-body-mixin {}
  * The left side for icons and images is the default case, it is implicit on styling
  *
  *
  **/

.vdm-teasers-mixin {
  .vdm-teaser-mixin {
    .vdm-teaser-body-mixin {
      @include teaser-base();
    }

    // Color modifiers
    &.light-scheme {
      .vdm-teaser-body-mixin {
        @include teaser-light-scheme();
      }
    }

    &.white-scheme {
      .vdm-teaser-body-mixin {
        @include teaser-white-scheme();
      }
    }

    // Case 1, icons
    &.icon-right {
      .vdm-teaser-body-mixin {
        @include teaser-variant(right);
      }
    }
    &.icon-left {
      .vdm-teaser-body-mixin {
        @include teaser-variant(left);
      }
    }

    // Major case 2, arrow blocks
    &.arrow-block {
      .vdm-teaser-body-mixin {
        @include teaser-variant(false, false, arrow-block);
        // @include teaser-scheme-hover(false, arrow-block);
      }
      &.light-scheme {
        .vdm-teaser-body-mixin {
          // @include teaser-scheme-hover(false, false);
        }
      }
      &.icon-left {
        .vdm-teaser-body-mixin {
          @include teaser-variant(left, false, arrow-block);
        }
      }
    }

    // Case 3, images

    &.image-right,
    &.image-left {
      .vdm-teaser-body-mixin {
        @include teaser-variant(false, left);
      }

      &.small {
        .vdm-teaser-body-mixin {
          @include teaser-variant(false, left, false, small);
        }
      }
      &.large {
        .vdm-teaser-body-mixin {
          @include teaser-variant(false, left, false, large);
        }
      }
      &.larger {
        .vdm-teaser-body-mixin {
          @include teaser-variant(false, left, false, larger);
        }
      }
    }

    // Images, left and right overides
    &.image-left {
      // No need to call it, it is the default case
    }

    &.image-right {
      .vdm-teaser-body-mixin {
        @include teaser-variant(false, right);
      }
    }

    // Other cases, exceptions
    &.compact {
      .vdm-teaser-body-mixin {
        @include teaser-variant(false, false, compact);
      }
    }

    &.inline-flex {
      .vdm-teaser-body-mixin {
        @include teaser-variant(false, false, inline-flex);
      }
    }
  }
}

// Base teaser styles
// Teasers are stacked horizontally and are not displayed side by side in a grid, ever
// Teasers may contain lateral images, these images will move up on smaller breakpoints
// Teasers are laid out in a horizontal flex axis

// Review opportunities for shared mixins with cards later on
.vdm-teaser {
  .vdm-teaser-body {
    // Flex properties
    display: flex;
    flex-direction: column;

    background: $vdm-grey-light;
    border: none;

    cursor: pointer;
    line-height: floor(($font-size-base * 1.2));
    text-decoration: none;
    color: $black;

    // Loop over all icons in the set to produce the classes & invoke the icon() mixin
    // Garbage
    @each $name, $char in $icons {
      &.ic-#{$name} {
        @include icon(before, $name);
      }
    }

    // Loop over all icons in the set to produce the classes & invoke the iconvfi() mixin
    // Keeper
    @each $name, $char in $vdmicons {
      &.ic-#{$name} {
        @include iconvfi(before, $name);
      }
    }

    // Left and right icons
    &:before,
    &:after {
      font-size: 3.6rem;
      width: 3.6rem;
      height: 3.6rem;
      line-height: 3.6rem;
      text-decoration: none;
      color: $vdm-brand;
      // border: 1px solid yellow;
    }

    // Active states, general
    &:hover,
    &:active {
      &.vdm-teaser-body {
        color: $white;
        background: $vdm-brand;
        text-decoration: none;
        &:before {
          color: $white;
        }
        > * {
          color: $white;
        }

        // Specific pseudo-elements overrides.
        .arrow-link,
        .location-pin,
        .vdm-label {
          color: $white;
          &:before,
          &:after {
            color: $white;
          }
        }
        .vdm-label {
          border: 1px solid $white;
        }
      }
    }

    .vdm-teaser-media {
      &img {
        @extend .img-fluid;
      }
    }

    // Standard fixtures, first children, title content footer
    .date {
      font-size: $font-size-xs;
      margin-bottom: 2rem;
    }
    .title {
      @include header(4);
      margin-bottom: 1em;
      //   border: 1px solid yellow;
      &.arrow-link {
        line-height: 1.7em;
      }
      &:last-child {
        margin-bottom: 0;
      }
    }
    .content {
      margin-bottom: 1.3em;
      flex: 1;
      &:last-child {
        margin-bottom: 0;
      }
    }
    .footer {
      margin-bottom: 0;
      margin-top: auto;

      &.inline-items {
        .location-pin {
          margin-right: 2em;
        }
      }
      .vdm-label {
        background: transparent;
      }
    }
  } // END teaser-body

  // Should not be applied at the same time as image classes
  ////////////////////////
  /////// Begin right arrow cases
  ////////////////////////

  &.arrow-block {
    // Base arrow block properties
    .vdm-teaser-body {
      @include icon(after, arrow-right);
      padding: 2.3rem 6rem 2.3rem 2.3rem;
      position: relative;

      &:after {
        position: absolute;
        top: calc(50% - 1.7rem);
        left: calc(100% - 4.5rem);
      }

      &:hover,
      &:active {
        color: $black;
        background: $vdm-grey-light;
        > * {
          color: $black;
        }
        &:after,
        &:before {
          color: $black;
        }
      }

      .title {
        @include header(4);
        // margin-bottom: 0.3em;
        margin-bottom: 0;
      }
      .footer {
        .date {
          color: $vdm-grey;
          font-size: $font-size-base;
        }
      }

      .feedback {
        text-transform: uppercase;
        color: $vdm-grey;
      }

      @include media-breakpoint-down(sm) {
        padding: 2.3rem 2.3rem 5.5rem 2.3rem;
        &:after {
          top: calc(100% - 5rem);
          left: calc(50% - 1.8rem);
        }
      }
    }

    // Search results types, compact scale
    &.compact {
      .vdm-teaser-body {
        // flex-direction: column;
        padding: 1rem 3.5rem 1rem 1rem;
        &:after {
          position: absolute;
          top: calc(50% - 1.7rem);
          left: calc(100% - 4rem);
          font-size: 2.8rem;
          width: 2.8rem;
          height: 2.8rem;
          line-height: 2.8rem;
        }

        .title {
          @include header(5);
          margin-bottom: 0.5em;
        }
        .content {
        }
        .footer {
        }
        @include media-breakpoint-down(sm) {
          padding: 1rem 5rem 1rem 1rem;
        }
      }
    }

    // Flip the flex direction, provide an inner container for vertical flow
    // Will often contain an identifier on the right
    &.inline-flex {
      .vdm-teaser-body {
        flex-direction: row;
        padding-right: 5rem;
        align-items: center;

        .content-wrapper {
          flex-direction: column;
          padding-right: 2rem;
        }
      }
      .identifier {
        text-transform: uppercase;
        color: $vdm-grey;
        font-size: $font-size-base;
        width: 30%;
        text-align: center;
        margin-top: 0.9rem;
      }

      @include media-breakpoint-down(sm) {
        .vdm-teaser-body {
          flex-direction: column;
          align-items: left;
          .content-wrapper {
            padding-right: 0;
          }
        }
        .identifier {
          align-self: center;
          width: auto;
          margin-top: 2rem;
        }
      }

      // Special use case, branded
      // Move the main paragraph outside the .content-wrapper block;
      &.category-block {
        .vdm-teaser-body {
          align-items: start;
          .content-wrapper {
            min-width: 35%;
            margin-right: 1rem;
            .title {
              color: $vdm-brand;
            }
          }
          .category-description {
            @include header(5);
          }
        }

        @include media-breakpoint-down(sm) {
          .vdm-teaser-body {
            .content-wrapper {
              width: 100%;
              margin-right: 0;
              margin-bottom: 1em;
            }
          }
        }
      }
    }

    // @ to-do : balance margin and icon scale left and right;
    // Includes an icon on the left and right side
    &.icon-left {
      .vdm-teaser-body {
        padding-left: 7rem;
        &:before {
          left: 2rem;
        }
        .title {
          @include header(4);
        }

        @include media-breakpoint-down(sm) {
          padding: 6.5rem 2.3rem 5.5rem 2.3rem;
          // border: 1px solid orange;
          &:after {
            top: calc(100% - 4.5rem);
            left: calc(50% - 1.8rem);
          }
          &:before {
            top: calc(1.8rem);
            left: calc(50% - 1.8rem);
          }
        }
      }
    }
  }

  // Color scheme modifiers
  // Shared with teasers, mixin
  &.light-scheme {
    .vdm-teaser-body {
      background: $white;
      border: 1px solid $vdm-brand;

      &:before {
        color: $black;
      }
    }
  }
  // Shared with teasers, mixin
  &.white-scheme {
    .vdm-teaser-body {
      background: $white;
      border: none;
      &:hover,
      &:active {
        background-color: $white;
        border: none;
        color: $black;
        &:before {
          color: $vdm-brand;
        }
      }
    }
  }

  ////////////////////////
  /////// Begin icon cases
  ////////////////////////

  &.icon-left,
  &.icon-right {
    .vdm-teaser-body {
      position: relative;
      &:before {
        position: absolute;
        top: calc(50% - 1.8rem);
      }
      .title {
        // margin-bottom: 0.3em;
        font-weight: $font-weight-bold;
      }
    }
  }

  &.icon-left {
    .vdm-teaser-body {
      padding: 2.3rem 2.3rem 2.3rem 7.75rem;
      &:before {
        left: 3rem;
      }
      @include media-breakpoint-down(xs) {
        padding: 7.75rem 2.3rem 2.3rem 2.3rem;
        &:before {
          top: 3rem;
          left: calc(50% - 1.8rem);
        }
      }
    }
  }

  &.icon-right {
    .vdm-teaser-body {
      padding: 2.3rem 7.75rem 2.3rem 2.3rem;
      &:before {
        left: calc(100% - 6.8rem); // Perceptual
      }
      @include media-breakpoint-down(xs) {
        padding: 7.75rem 2.3rem 2.3rem 2.3rem;
        &:before {
          top: 3rem;
          left: calc(50% - 1.8rem);
        }
      }
    }
  }

  ////////////////////////
  /////// Begin teaser image cases
  ////////////////////////
  /*

    Cases studied : 
    https://projects.invisionapp.com/d/main#/console/11533069/247010233/preview
    https://projects.invisionapp.com/d/main#/console/11533069/248691983/preview
    https://projects.invisionapp.com/d/main#/console/11533069/245247105/preview
    https://projects.invisionapp.com/d/main#/console/11533069/245692118/preview

    Image heights : 432, 487 & 768 pixels, all widths are 768px.

    */

  &.image-left,
  &.image-right {
    .vdm-teaser-body {
      flex-direction: row;
      > img {
        max-height: 10rem;
        margin: 0;
      }
    }

    &.large {
      .vdm-teaser-body {
        > img {
          max-height: 16rem;
        }
      }
    }

    &.larger {
      .vdm-teaser-body {
        > img {
          max-height: 22rem;
        }
        .title {
          @include header(4, bold);
        }
        .content {
          @include header(5);
        }
      }
    }

    &.small {
      .content-wrapper {
        padding: 1.5rem 1.5rem 1.8rem 1.5rem;
      }
    }

    // Inner content wrapper - required for teasers with images.
    // What for ?  ->  to change the flex axis & provide padding, independent from image
    .content-wrapper {
      padding: 1em;
      display: flex;
      flex-direction: column;
      flex: 1;
      padding: 2.3rem 2.3rem 3rem 2.3rem;

      .title {
        @include header(5);
        &.arrow-link {
          line-height: 1.7em;
        }
      }
    }

    // Grid styles
    // Careful, the 768 px image is being scaled-up!
    @include media-breakpoint-down(md) {
      &.large,
      &.larger {
        .vdm-teaser-body {
          flex-direction: column;
          > img {
            order: 0;
            width: 100%;
            max-height: none;
          }
        }
      }
    }
    @include media-breakpoint-down(xs) {
      .vdm-teaser-body {
        flex-direction: column;
        > img {
          order: 0;
          width: 100%;
          max-height: none;
        }
      }
    }
  }

  &.image-left {
  }

  &.image-right {
    .vdm-teaser-body {
      > img {
        order: 1; // Change source order
      }
    }

    @include media-breakpoint-down(xs) {
      .vdm-teaser-body {
        flex-direction: column;
        > img {
          order: 0;
          width: 100%;
          max-height: none;
        }
      }
    }
  }
}
